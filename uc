#!/bin/bash
###############################################################################
# This script is a wrapper for unicornscan.
# It will do a full port scan and output the ports in an nmap friendly format.
# i.e. nmap -p $(uc <target>) -sTUV <target>
# It takes around 8 minutes to complete.
#
# I like to put uc in /usr/local/bin
#
# Reference: https://tools.kali.org/information-gathering/unicornscan
###############################################################################
PRET='T:'
PREU='U:'
JOINER=','
if [[ -n ${1} ]];then
  TSTRING=$(unicornscan -mT -p 1-65535 ${1} | awk -F"[" {' print $2 '} | sed s'/].*//g' | tr "\n" "," | sed s'/ //g' | sed 's/.$//')
  USTRING=$(unicornscan -mU -p 1-65535 ${1} | awk -F"[" {' print $2 '} | sed s'/].*//g' | tr "\n" "," | sed s'/ //g' | sed 's/.$//')
else
  echo 'Please provide an IP address'
  exit 1
fi

if [[ -n "${TSTRING}" && -n "${USTRING}" ]];then
  printf "${PRET}${TSTRING}${JOINER}${PREU}${USTRING}\n"
elif [[ -n "${TSTRING}" && -z "${USTRING}" ]];then
  printf "${PRET}${TSTRING}\n"
elif [[ -z "${TSTRING}" && -n "${USTRING}" ]];then
  printf "${PREU}${USTRING}\n"
fi

exit 0
